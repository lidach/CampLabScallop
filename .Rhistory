with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,1), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
# #  plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,110000), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.25e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen")
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,1), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
# #  plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.25e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen")
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,1), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.5e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.25e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen")
})
scen_bagnum$results$eggs
scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn
sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,1), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1.5e7), xlim=c(0,120))
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,1), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="")
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,1), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=at=seq(0,1,0.2), las=1)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,1), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,2), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,2), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4, las=1)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,2), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4, adj=0)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,2), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4, las=1, outer=F)
})
mtext(text="Depletion (Eggs Deposited)", side=4, las=2, outer=F)
mtext(text="Depletion (Eggs Deposited)", side=4, las=0, outer=F)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,2), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
windows()
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(10,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(1,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(50,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(70,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(30,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(40,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(50,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
# Scenarios
with(scen_bagnum$results,{
par(mfrow=c(3,2), mar=c(3,5,1,3), las=1, mgp=c(4,1,0))
plot(time, VB, type="l", col="blue",ylab="Vul Biomass",lwd=3, ylim=c(0, max(VB)))
abline(lm(VB~time), lwd=2, lty=3)
plot(time, N/N[1], type='l', ylab = "Depletion (Numbers)", ylim=c(0,1), lwd=2, col="mediumpurple4")
et2 <- et
et2[et2==0] <- NA
plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,50000))
#   plot(time, et2, col="red", lwd=3, type='l',ylab="Effort (Vessels)", ylim=c(0,95000))
plot(time[yield_n>0], yield_n[yield_n>0], type='p', pch=16,ylab = "Catch (numbers)", ylim=c(0,1.75e6), col="salmon3", cex=1.5, xlim=c(0,120))
abline(v=seq(0.5,120.5,12), lty=2)
plot(time[recruits>0], recruits[recruits>0], type='p', pch=16, ylab = "Recruits", xlim=c(0,120), ylim=c(0,3.5e7), col='darkgreen', cex=1.5)
plot(time, eggs_mon, type='l', ylab = "Eggs (Monthly)", ylim=c(0,1.5e6), lwd=2, col="seagreen", xlim=c(0,120))
par(new=T)
plot(time[eggs>0], eggs[eggs>0]/sum(scen_bagnum$scenario$life$Ro * scen_bagnum$scenario$life.vec$Lo *  scen_bagnum$scenario$life.vec$Mat * scen_bagnum$scenario$life.vec$Fec *  scen_bagnum$scenario$life.vec$prob_spawn)
, type="b", ylim=c(0,1), xlim=c(0,120),ylab="", xlab="", xaxt="n", yaxt="n")
axis(side=4, at=seq(0,1,0.2), labels=seq(0,1,0.2), las=1)
mtext(text="Depletion (Eggs Deposited)", side=4,line=2.5,las=0, outer=F, cex=0.8)
})
maxcat <- 40*2.5
lapply(maxcat, function(x) seq(0,x,by=1))
bag <- rep(40,12)
maxcat <- bag*2.5
lapply(maxcat, function(x) seq(0,x,by=1))
catch.rate <- lapply(maxcat, function(x) seq(0,x,by=1))
ret <- lapply(1:12, function(x) pmin(catch.rate[[x]],bag[x]))
ret
scen_bagnum$results$hcpue
dpois(scenario$catch$catch.rate[[1]],scen_bagnum$results$hcpue)
dpois(catch.rate[[1]],scen_bagnum$results$hcpue)
catch.rate[[1]]
dpois(catch.rate[[1]],scen_bagnum$results$hcpue[1])
dpois(catch.rate[[1]],scen_bagnum$results$hcpue[7])
windows()
plot(dpois(catch.rate[[1]],scen_bagnum$results$hcpue[7]))
plot(dpois(catch.rate[[1]],scen_bagnum$results$hcpue[7])/sum(dpois(catch.rate[[1]],scen_bagnum$results$hcpue[7])))
dens_catch<-dpois(catch.rate[[1]],scen_bagnum$results$hcpue[7])/sum(dpois(catch.rate[[1]],scen_bagnum$results$hcpue[7]))
dens_catch*ret
dens_catch*ret[[1]]
plot(dens_catch*ret[[1]])
scen_bagnum$results$hpue[1]/scen_bagnum$results$hcpue[1]
scen_bagnum$results$hpue
scen_bagnum$results$hcpue
scenariobagnum <- scenario
scenariobagnum$catch$bag <- rep(30,12)
scenariobagnum$catch$bag_unit = "numbers"
scen_bagnum <- scallop_model_fun(scenariobagnum)
scen_bagnum$results$hpue
scen_bagnum$results$hcpue
scen_bagnum$results$hpue/scen_bagnum$results$hcpue''
scen_bagnum$results$hpue/scen_bagnum$results$hcpue
M<-0.2
F<-0.2
N<-1000*exp(-M+F)
N
N<-1000*exp(-(M+F))
N
C<-F/(M+F)*1000*(1-exp(-(M+F)))
C
1000-C*2
C/1000
1-exp(-F)
1-exp(-(F+M))
(1-exp(-(F+M)))*1000
C*2
scen_bagnum$results$hcpue
scen_bagnum$scenario$catch$q
scen_bagnum$scenario$catch$q*scen_bagnum$results$N
1000*exp(-4)
1000*exp(-.4)
1000*(1-exp(-0.2))*(1-exp(-0.2))
1-exp(-0.2)
1000*exp(-0.2)*exp(-0.2)
